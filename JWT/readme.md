# JWTs

JSON Web Token (JWT) is a compact, URL-safe means of representing claims to be transferred between two parties.  The claims in a JWT are encoded as a JSON object that is used as the payload of a JSON Web Signature (JWS) structure or as the plaintext of a JSON Web Encryption (JWE) structure, enabling the claims to be digitally signed or integrity protected with a Message Authentication Code (MAC) and/or encrypted.

#### When to use JWTs

Most commonly, for authentication. Single sign on is a feature that widely uses JWT, because of its small overhead and its ability to be easily used across different domains. Once the use is logged in, each subsequent request will include the JWT recieved after successful log in.



#### JWT Structure

```header.payload.signature```

each part is separated by '.'s.

##### Header

the header typically consists of two parts:

```
{
  "alg": "HS256",
  "typ": "JWT"
}
```

- alg is the hashing algorithm being used, such as HMAC SHA256 or RSA.


- type is the type of the token, in this case "JWT".

Then, this JSON is **Base64Url** encoded to form the first part of the JWT.

##### Payload

The payload of a JWT is **Base64Url** encoded. The payload contains the claims.

Claims are statements about an entity (typically, the user) and additional metadata. There are three types of claims: *reserved*, *public*, and *private* claims.

An example of a payload could be:

```
{
  "sub": "1234567890",
  "name": "John Doe",
  "admin": true
}
```

this would then be **Base64Url** encoded.

##### Signature

header.payload._**signature**_

the final section of the JWT is the signature. The signature is generated by using the algorithm that is defined in the header.

````
HMACSHA256(
  base64UrlEncode(
    { //header
      typ: "JWT",
      alg: "HS256"
    }
  )
  + "." +
  base64UrlEncode(payload),
  secret // secret must remain secret - it's a password essentially
);
````

##### Putting all together

The output is three Base64 strings separated by dots that can be easily passed in HTML and HTTP environments, while being more compact when compared to XML-based standards such as SAML.

## What is RSA?

Mentioned above, RSA is a hashing algorithm.

RSA (Rivest-Shamir-Adleman) is one of the first practical public-key cryptosystems and is widely used for secure data transmission.




## Implicit flow of Auth0
*Gain an understanding of the flow and what is going on at a level to be able to explain it to another*



Implicit flow is a concept used by client-side apps use in order to access an API.

- Send the user to the authorization URL

  - ```
    https://YOUR_AUTH0_DOMAIN/authorize?
      audience=YOUR_API_UUID&
      scope=YOUR_SCOPE&
      response_type=YOUR_RESPONSE_TYPE& // eg access_toekn
      client_id=YOUR_CLIENT_ID& // app id
      redirect_uri=https://YOUR_APP/callback&
      state=YOUR_OPAQUE_VALUE
      nonce=YOUR_CRYPTOGRAPHIC_NONCE
    ```

- Extract the Access Token from the hash fragment of the URL

  - ```
    function getParameterByName(name) {
      var match = RegExp('[#&]' + name + '=([^&]*)').exec(window.location.hash);
      return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    }
    		
    $(function () {
      var access_token = getParameterByName('access_token');
    });
    ```

- Call the API

  - Passing the access_token in the header as a Bearer Token

  - ```` 
    $.ajax({
        cache: false,
        url: "http://localhost:7001/api/appointments",
        headers: { "Authorization": "Bearer " + access_token }
    ````

- Verify the Token

  - Auth0's access_tokens are formatted as a JWT. And must pass the following validations (in the order below), otherwise the request *must* be rejected.
    1. Check that the JWT is well formed
    2. Check the signature
    3. Validate the standard claims
    4. Check the Client permissions (scopes)

  â€‹
